function hw10
clear; close all;

% First day in the data series corresponds to 11/25/2008
% First column of data contains volume traded, following four columns
% contain high, low, open and close prices for the stock. The 6th column
% containes the days between the prices in different rows (1 for regular 
% days of the week, 3 for weekends, 4 for long weekends and 2 for
% holidays). The 7th column contains the number of days elapsed since
% 11/24/2008.

% Use close price for your analysis

%    Volume(M) High      Low       Open      Close   days between prices    days elapsed
aux=[82.90     16.49     15.28     16.49     15.42                1         1
     54.90     16.49     15.17     15.20     16.39                1         2
     22.48     16.55     16.16     16.19     16.54                2         4
     62.92     16.17     14.93     16.16     14.96                3         7
     65.67     15.39     14.75     15.17     15.32                1         8
     69.60     16.03     14.86     14.91     16.01                1         9
     59.17     16.09     15.02     15.65     15.33                1        10
     67.56     16.10     14.72     15.16     15.94                1        11
     82.28     17.45     16.45     16.50     17.25                3        14
     67.34     17.93     16.75     16.91     17.16                1        15
     50.80     17.76     17.08     17.30     17.33                1        16
     56.28     17.64     16.83     17.13     16.91                1        17
     47.02     17.19     16.51     16.53     16.99                1        18
     40.17     17.02     16.51     16.88     16.84                3        21
     77.77     17.45     16.69     17.04     17.42                1        22
     62.83     17.34     16.71     17.17     16.84                1        23
     52.39     16.91     16.44     16.87     16.66                1        24
     62.20     16.95     16.60     16.64     16.64                1        25
     38.80     16.71     15.99     16.61     16.37                3        28
     30.39     16.65     16.07     16.42     16.24                1        29
     11.59     16.43     16.21     16.25     16.35                1        30
     15.16     16.42     16.09     16.36     16.27                2        32
     33.25     16.25     15.73     16.16     16.01                3        35
     31.09     16.25     15.94     16.04     16.23                1        36
     37.51     16.55     16.12     16.18     16.30                1        37
     40.98     17.00     16.25     16.41     16.96                2        39
     45.48     17.30     16.75     16.85     17.11                3        42
     58.27     17.98     17.26     17.33     17.79                1        43
     50.26     17.58     17.11     17.37     17.32                1        44
     46.48     17.57     17.00     17.23     17.54                1        45
     68.23     17.26     16.61     17.24     16.70                1        46
     54.92     16.78     16.03     16.68     16.40                3        49
     51.93     16.54     16.11     16.29     16.45                1        50
     50.17     16.22     15.60     16.10     15.74                1        51
     61.81     15.95     15.19     15.62     15.81                1        52
     66.93     16.33     15.50     16.22     15.82                1        53
     57.81     15.93     15.01     15.81     15.01                4        57
     56.24     15.76     15.05     15.32     15.70                1        58
     56.67     15.59     15.00     15.38     15.37                1        59
     56.55     16.02     15.00     15.04     15.89                1        60
     44.63     16.50     15.78     15.85     16.30                3        63
     50.35     17.00     16.29     16.43     16.73                1        64
     60.14     17.19     16.69     17.06     16.88                1        65
     53.23     16.70     15.80     16.70     15.93                1        66
     75.29     16.09     14.91     15.91     14.97                1        67
     55.29     15.46     14.83     14.86     15.31                3        70
     65.93     15.75     15.01     15.48     15.62                1        71
     95.64     16.16     15.38     15.72     15.84                1        72
    115.56     16.65     15.45     15.54     16.35                1        73
     62.89     17.09     16.21     16.42     17.04                1        74
     37.62     17.05     16.62     16.99     16.85                3        77
     69.14     16.93     15.92     16.59     16.05                1        78
     46.28     16.27     15.85     16.18     16.17                1        79
     57.64     16.22     15.63     15.97     16.20                1        80
     43.64     16.46     15.95     16.20     16.10                1        81
     47.96     15.76     15.28     15.68     15.29                4        85
     40.63     15.73     15.15     15.45     15.37                1        86
     42.98     15.52     15.01     15.46     15.04                1        87
     59.37     15.34     14.88     14.96     15.08                1        88
     51.68     15.35     14.31     15.20     14.36                3        91
     55.47     15.05     14.38     14.39     14.99                1        92
     56.28     15.13     14.37     14.92     14.77                1        93
     51.00     15.21     14.49     15.05     14.49                1        94
     76.73     14.82     14.30     14.30     14.57                1        95
     59.92     14.78     14.27     14.33     14.32                3        98
     62.32     14.73     14.36     14.49     14.39                1        99
     69.57     15.52     14.63     14.64     15.25                1       100
     67.03     15.09     14.51     14.94     14.55                1       101
    113.69     14.93     13.98     14.58     14.18                1       102
     78.29     14.43     13.61     14.00     13.62                3       105
     71.61     14.79     13.92     14.04     14.64                1       106
     54.94     15.20     14.52     14.79     15.02                1       107
     49.60     15.51     14.77     15.00     15.51                1       108
     43.12     15.69     15.25     15.46     15.51                1       109
     50.23     15.88     15.35     15.79     15.45                3       112
     52.04     16.15     15.57     15.72     16.14                1       113
     84.92     16.94     16.02     16.03     16.50                1       114
     56.40     16.68     16.06     16.68     16.23                1       115
     66.07     16.57     15.75     16.37     15.91                1       116
     64.33     17.00     15.90     16.31     16.98                3       119
     44.60     17.04     16.58     16.70     16.68                1       120
     64.20     17.05     16.28     16.50     16.57                1       121
     58.04     17.39     16.76     16.80     17.31                1       122
     37.83     17.17     16.85     17.00     16.95                1       123
     45.04     16.57     16.08     16.57     16.31                3       126
     59.04     17.01     16.37     16.53     16.77                1       127
     73.39     17.54     16.30     16.51     17.46                1       128
     88.34     18.61     17.79     17.83     18.14                1       129
     59.47     18.54     17.95     18.30     18.16                1       130
     63.35     17.64     17.07     17.56     17.53                3       133
     59.88     17.25     16.58     17.20     16.85                1       134
     45.38     17.33     16.94     17.29     17.13                1       135
     53.09     18.08     17.58     17.67     17.82                1       136
     33.96     18.05     17.76     17.85     17.89                4       140
     42.81     18.18     17.61     17.80     17.93                1       141
     51.88     18.00     17.34     17.75     17.56                1       142
     51.38     18.18     17.65     17.82     18.08                1       143
     55.98     18.17     17.83     18.10     17.99                1       144
     55.16     17.79     17.20     17.71     17.31                3       147
     45.75     17.79     17.14     17.20     17.69                1       148
     54.72     18.02     17.43     17.45     17.44                1       149
     43.94     17.64     17.13     17.52     17.62                1       150
     55.66     18.50     17.97     18.12     18.42                1       151
     42.30     18.59     18.01     18.10     18.37                3       154
     47.82     18.96     18.15     18.30     18.67                1       155
     48.49     19.53     18.73     18.83     19.25                1       156
     60.35     19.93     19.10     19.69     19.32                1       157
     40.33     19.78     19.06     19.24     19.58                1       158
     63.89     19.87     19.26     19.82     19.50                3       161
     46.38     19.63     19.28     19.50     19.63                1       162
     93.14     19.85     19.03     19.76     19.61                1       163
     92.35     20.00     18.60     20.00     18.95                1       164
     65.44     19.22     18.55     19.00     18.73                1       165
     44.32     18.83     18.27     18.45     18.61                3       168
     39.75     18.82     18.55     18.67     18.72                1       169
     50.68     18.60     18.03     18.49     18.05                1       170
     43.08     18.29     18.05     18.07     18.09                1       171
     72.10     18.21     17.77     18.14     17.92                1       172
     67.49     18.81     18.06     18.14     18.72                3       175
     53.82     19.35     18.64     18.71     18.88                1       176
     49.03     19.06     18.46     19.02     18.60                1       177
     63.31     18.50     17.85     18.43     18.10                1       178
     33.24     18.15     17.66     18.09     17.90                1       179
     48.66     18.67     17.61     17.66     18.49                4       183
     40.02     18.71     18.11     18.41     18.22                1       184
     53.07     18.66     18.06     18.35     18.51                1       185
     61.03     18.60     18.09     18.54     18.50                1       186
    103.31     19.77     19.01     19.15     19.50                3       189
     53.77     19.86     19.41     19.57     19.61                1       190
     55.11     19.61     19.10     19.55     19.36                1       191
     40.58     19.81     19.30     19.46     19.67                1       192
     86.04     20.02     19.52     19.94     19.87                1       193
     42.84     20.06     19.53     19.74     19.87                3       196
     49.75     20.20     19.68     19.95     20.08                1       197
     58.38     20.24     19.60     20.19     19.95                1       198
     44.78     20.35     19.90     19.93     20.10                1       199
     41.37     20.00     19.63     19.93     19.91                1       200
     47.96     19.70     19.10     19.68     19.36                3       203
     45.36     19.48     19.03     19.42     19.08                1       204
     48.81     19.49     18.97     19.04     19.20                1       205
     37.56     19.29     18.92     19.23     18.99                1       206
     71.69     19.20     18.80     19.18     18.92                1       207
     46.17     18.80     18.35     18.75     18.41                3       210
     42.67     18.71     18.25     18.43     18.57                1       211
     47.13     19.00     18.52     18.74     18.61                1       212
     43.53     19.19     18.50     18.59     19.03                1       213
     47.17     19.16     18.85     18.92     18.91                1       214
     49.22     19.05     18.79     19.00     18.99                3       217
     53.79     19.07     18.53     18.94     18.65                1       218
     36.63     19.10     18.76     18.84     18.80                1       219
     41.55     18.73     18.45     18.67     18.50                1       220
     35.30     18.70     18.30     18.32     18.53                4       224
     41.52     18.62     18.19     18.54     18.24                1       225
     53.55     18.33     17.82     18.25     18.13                1       226
     52.93     18.51     18.06     18.27     18.17                1       227
     46.64     18.45     18.02     18.08     18.34                1       228
     62.37     18.58     17.92     18.41     18.57                3       231
     46.98     18.94     18.43     18.43     18.73                1       232
     87.94     19.88     19.16     19.32     19.81                1       233
     57.77     20.20     19.71     19.74     20.12                1       234
     69.17     20.58     19.98     20.18     20.51                1       235
     78.88     21.27     20.80     20.82     21.15                3       238
     72.56     21.59     20.88     21.27     21.59                1       239
     52.60     21.83     21.27     21.44     21.45                1       240
     62.81     22.07     21.28     21.44     21.90                1       241
     40.63     21.97     21.42     21.48     21.88                1       242
     31.60     21.95     21.67     21.85     21.84                3       245
     40.08     21.99     21.37     21.62     21.93                1       246
     33.62     21.87     21.50     21.80     21.72                1       247
     52.88     22.40     21.84     21.98     21.98                1       248
     41.67     22.18     21.85     21.94     22.01                1       249
     60.93     22.61     22.19     22.21     22.57                3       252
     55.86     22.55     22.19     22.45     22.44                1       253
     78.85     22.57     22.01     22.55     22.17                1       254
     83.30     22.41     21.68     22.04     22.31                1       255
     46.92     22.74     22.15     22.49     22.19                1       256
     46.63     22.12     21.50     21.98     21.64                3       259
     53.60     21.53     21.06     21.47     21.17                1       260
     49.47     21.61     21.18     21.23     21.43                1       261
     38.93     21.65     21.34     21.54     21.51                1       262
     35.13     21.55     21.00     21.47     21.31                1       263
     32.43     20.96     20.68     20.94     20.73                3       266
     33.33     21.15     20.79     20.82     21.01                1       267
     39.23     21.44     20.74     20.76     21.24                1       268
     55.77     21.96     21.20     21.25     21.89                1       269
     56.58     22.27     21.77     22.08     22.19                1       270
     52.70     22.64     21.93     22.22     22.06                3       273
     28.40     22.25     21.85     22.16     22.00                1       274
     33.58     22.00     21.81     21.91     21.93                1       275
     30.29     21.91     21.47     21.67     21.88                1       276
     35.94     22.35     21.80     22.15     22.00                1       277
     31.40     21.84     21.51     21.74     21.60                3       280
     48.75     21.87     21.08     21.46     21.17                1       281
     40.23     21.73     21.07     21.09     21.55                1       282
     33.83     21.90     21.34     21.73     21.49                1       283
     28.95     21.96     21.40     21.59     21.84                1       284
     39.95     22.21     21.79     22.00     21.92                4       288
     45.12     22.52     21.96     21.97     22.23                1       289
     76.61     23.05     22.01     22.15     23.01                1       290
     53.49     23.13     22.61     22.92     23.09                1       291
     60.61     22.99     22.61     22.85     22.79                3       294
     50.92     23.19     22.66     22.83     22.98                1       295
     53.65     23.45     23.00     23.07     23.36                1       296
     40.43     23.49     23.16     23.22     23.39                1       297
     53.79     23.61     23.24     23.50     23.40                1       298
     51.07     23.85     23.18     23.20     23.63                3       301
     34.92     23.72     23.30     23.71     23.41                1       302
     65.54     23.53     22.75     23.52     22.80                1       303
     39.00     22.99     22.46     22.84     22.65                1       304
     41.07     22.92     22.57     22.57     22.62                1       305
     68.94     23.87     23.27     23.29     23.61                3       308
     40.22     23.74     23.21     23.62     23.30                1       309
     64.47     23.79     22.96     23.55     23.54                1       310
     63.03     23.58     23.07     23.35     23.09                1       311
     42.03     23.08     22.62     22.86     22.67                1       312
     38.74     23.11     22.58     22.91     22.94                3       315
     41.38     23.57     23.07     23.16     23.35                1       316
     43.25     23.78     23.41     23.48     23.61                1       317
     45.90     23.92     23.55     23.83     23.67                1       318
     45.65     24.08     23.50     23.64     24.03                1       319
     32.79     24.22     23.62     24.07     23.78                3       322
     45.58     24.13     23.57     23.58     23.89                1       323
     49.20     24.50     24.18     24.26     24.38                1       324
     35.85     24.37     24.06     24.25     24.37                1       325
     38.02     24.13     23.70     24.10     24.02                1       326
     30.64     24.83     23.96     24.13     24.25                3       329
     52.45     24.55     23.96     24.37     24.11                1       330
     41.88     24.50     23.85     24.12     23.96                1       331
     33.91     24.25     23.83     23.90     24.18                1       332
     42.52     24.52     24.03     24.52     24.17                1       333
     45.68     24.40     23.63     24.15     23.70                3       336
     42.69     23.95     23.40     23.72     23.54                1       337
     47.52     23.53     22.97     23.37     23.02                1       338
     40.05     23.58     23.06     23.11     23.52                1       339
     61.21     23.48     22.64     23.46     22.81                1       340
     55.06     23.20     22.62     22.87     23.00                3       343
     46.37     23.04     22.55     22.82     22.91                1       344
     65.46     23.43     23.00     23.31     23.29                1       345
     87.73     24.07     23.62     24.05     23.93                1       346
     36.61     24.00     23.66     23.71     23.82                1       347
     46.89     24.00     23.72     23.93     23.99                3       350
     43.07     23.87     23.55     23.70     23.65                1       351
     39.22     24.00     23.71     23.73     23.92                1       352
     63.81     23.84     23.17     23.74     23.40                1       353
     35.80     23.80     23.45     23.51     23.71                1       354
     47.56     24.10     23.65     23.77     23.87                3       357
     37.20     24.11     23.82     23.92     24.09                1       358
     27.23     24.04     23.79     24.01     24.00                1       359
     38.10     23.88     23.41     23.87     23.68                1       360
     36.32     23.57     23.30     23.50     23.46                1       361
     29.30     23.91     23.65     23.69     23.90                3       364
     29.98     23.90     23.56     23.83     23.74                1       365];

volume_traded = aux(:,1); 
high_price    = aux(:,2);
low_price     = aux(:,3);
open_price    = aux(:,4);
close_price   = aux(:,5);
days_between_prices = aux(:,6);
days_elapsed        = aux(:,7);

% B(close_price)
% C(close_price)
H(close_price)

end

function B(close_price)
Z=log(close_price);
Y=Z(2:end)-Z(1:end-1);
N=length(Y);
h=1/365;
mu_hat=sum(Y)/(N*h) % Sample mean
sigma_sqr_hat=sum((Y-mu_hat*h).^2)/((N-1)*h) % Sample variance

end

function C(close_price)
Z=log(close_price);
 Y=Z(2:end)-Z(1:end-1);
 N=length(Y);
 h=1/365;
 x=-0.1:0.01:0.1;
 n_elements = histc(Y,x);
 figure(1)
 bar(x,n_elements/N/0.01,'r')
 hold on
 mu_hat=0.6275;
 sigma_sqr_hat=0.2174;
 x_padded=-0.1:0.001:0.1;
 plot(x_padded,normpdf(x_padded, mu_hat*h, sqrt(sigma_sqr_hat*h)),'Linewidth',3)
 grid on
 axis([-0.1 0.1 0 25])
 
 figure(2)
 c_elements= cumsum(n_elements)/N;
 bar(x, c_elements, 'r')
 hold on 
 x_padded=-0.1: 0.001:0.1;
 plot(x_padded, normcdf(x_padded, mu_hat*h, sqrt(sigma_sqr_hat*h)),'Linewidth',3)
 grid on 
 axis([-0.1 0.1 0 1])
end


function H(close_price)
 Z=log(close_price);
 Y=Z(2:end)-Z(1:end-1);
 N=length(Y);
 h=1/365;
 mu_hat=sum(Y)/(N*h) % Sample mean
 sigma_sqr_hat=sum((Y-mu_hat*h).^2)/((N-1)*h) % Sample variance
 alpha=0.0375;
 X_0=close_price(1,1);
 EX=X_0*exp(mu_hat+sigma_sqr_hat/2);
 K=[0.8 1 1.2]*EX;
 a=(log(K/X_0)-(alpha-sigma_sqr_hat/2))/(sqrt(sigma_sqr_hat));
 b=a-sqrt(sigma_sqr_hat);
 Q_a=1-normcdf(a,0,1);
 Q_b=1-normcdf(b,0,1);
 c=X_0*Q_b-exp(-alpha)*K.*Q_a
end

